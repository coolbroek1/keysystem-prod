<!doctype html><meta charset="utf-8">
<title>Verify Step 2</title>
<style>body{background:#0b1220;color:#e8ecf4;font-family:Inter,system-ui,Arial;padding:30px} .muted{color:#9aa3b2}</style>
<div id="out" class="muted">Verifying step 2…</div>
<script>
(async function(){
  const out = document.getElementById('out');
  const u = new URL(location.href);
  const hash = u.searchParams.get('hash');
  const hwid = u.searchParams.get('hwid') || '';
  if (!hash){ out.textContent = 'Missing Linkvertise hash. Open the link again from the portal.'; return; }

  try{
    const r = await fetch('/.netlify/functions/lv-verify?step=2&hash='+encodeURIComponent(hash)+(hwid?('&hwid='+encodeURIComponent(hwid)):''));
    const d = await r.json();
    if (d.ok){
      try{ localStorage.setItem('lv2','1'); if(hwid) localStorage.setItem('hwid', hwid); }catch(_){}
      out.textContent = 'Step 2 verified. Redirecting…';
      setTimeout(()=>location.replace('/'), 500);
    } else {
      out.textContent = 'Verification failed (step 2). Please complete the Linkvertise step again.';
    }
  } catch(e){
    out.textContent = 'Network error while verifying. Try again.';
  }
})();
</script>
